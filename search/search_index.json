{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"index.html","title":"Introduction","text":""},{"location":"index.html#introduction","title":"Introduction","text":"<p>This is a sample project for a file Explorer with mappView. It allows you to delete and copy files or directories between two locations. Navigate through the folder structure by double tapping on a folder name. Access USB sticks and network shares and use them like local folders.</p> <p></p> <p>See How to import the file explorer into an existing project. Download the latest release from here. When upgrading from a previous version make sure to delete the files that were imported before. Detailed information are available in the Wiki. This sample can run in simualtion mode (http://127.0.0.1:81/).</p>"},{"location":"index.html#changes-between-version-1x-and-2x","title":"Changes between version 1.x and 2.x","text":"<ul> <li>Update to Automation Studio AS6. Keep in mind that with AS6 it is no longer possible to access partitions with a driver letter. The only supported way is to use the USER_PATH variable that points to the user partition on the memory card.</li> <li>Replaced upload and download implementation to transfer widget.</li> <li>The upload widget no longer asks to overwrite existing files, the file is always overwritten.</li> </ul>"},{"location":"index.html#requirements","title":"Requirements","text":"<ul> <li>Automation Studio 6.x</li> <li>mappView 6.x</li> <li>Automation Runtime 6.x</li> </ul> <p>Recommended task class is #8 with a 10ms cycle time.    </p>"},{"location":"description.html","title":"Description","text":""},{"location":"description.html#description","title":"Description","text":"<p>The sample consists of three tasks and a mappView sample page. The task FileExplorer handles the files and folder operations as well as the navigation. The two additional helper tasks USBdevice and NETdevice allow the connection of USB sticks and network devices. The USBdevice tasks auto detects and mounts connected USB sticks. The sample page shows all available functions and can be used as a starting point. The following functions are currently supported.</p> <ul> <li>Copy one or all files or folders</li> <li>Delete one or all files or folders</li> <li>Create a new folder</li> <li>Rename file or folder</li> <li>Download files and folders</li> <li>Upload files</li> <li>View files</li> </ul> <p>When uploading or copying a single file that exists on the target an additional message box will ask if the file should be overwritten. However, the copyall command will overwrite all existing files without asking. The upload and download functions have their limits and are meant from small file sizes. Since the upload and download buffer is taken from the PLC memory larger files are only possible when enough memory is available.</p> <p>The task uses a variable structure to communicate with the outside world that can also be used to interact with other tasks. Since there are two sides in the file explorer most data exists twice. The structure looks as follows:</p> Level 1 Level 2 Level Description CMD Used to trigger commands like copy, delete, create, ... A command is triggered by setting it to true, when the command is finished the task will reset the command. This indicates that the command is finished. Do not change any parameters or set another command until the previous command is finished. refresh Read files and folder information dir_change Change to the folder name stored in PAR-&gt;dir_name dir_create Create new folder copy Copy selected file or folder copyall Copy all files and folders. The command will overwrite all existing files on the target. delete Delete file or folder rename Rename a file or folder download Download a file or folder upload Upload a filer  PAR  Parameters like item filter, directory path, ... device_active Active device name device_list List of all available devices name that can be used, see constant definition below item_filter Only files and folders that fit this pattern will be listed new_name Use with command rename and directory create dir_path Complete folder path  DAT  File and folder information item_list List of files and folders item_size File size item_num Number of files and folders device_free Free memory on device device_mem Total memory on device  VIS  Data specific for the visualization. item_selected File or folder that is selected in mappView enable_button_set_1 Enables/Disables the buttons where at least on entry is required like copy, delete or view enable_button_set_2 Enables/Disables the buttons like refresh or create directory view_file_path Full path for web widget to view file view_file Opens the fly out window to view a file download_file_url File upload and download url upload_overwrite_request Show message box to overwrite file upload_overwrite_response Response from message box overwrite file upload_overwrite_response Response from message box overwrite file reload_upload Reload upload button device_list Same information as PAR-&gt;device_list but formatted for mappView double_click_event Helper variable to detect double click on item list device_list Same information as PAR-&gt;device_list but formatted for mappView  ERR  Information about errors no Error number state State where the error occurred  status_no  Shows the status as number  status_text  Shows the status as text"},{"location":"description.html#pre-configuration","title":"Pre-Configuration","text":"<p>The sample can be pre-configured through the following constants located in  mappFileExplorer-&gt;ExplorerVariables.var</p> Constant Default Text EXPL_DIR_PATH_LENGTH 200 Maximum length for the complete path EXPL_LIST_NUM 100 Maximum number if files and folders that can be listed EXPL_ITEM_LENGTH 50 Maximum length for a file or folder name EXPL_SIZE_LENGTH 15 Maximum length for the file size information EXPL_DEVICE_LIST USER,USB_DEVICE,NET_DEVICE List if predefined devices EXPL_VIEW_FILTER csv, xml, bmp, jpg, txt File extensions that can be used with the view command. The filter is case sensitive."},{"location":"description.html#configuration-at-runtime","title":"Configuration at runtime","text":"<p>The following settings can be changed during runtime for USB and network connection. For details about the network settings see the Automation Help (6bc04f87-a564-42fe-be38-060045eb83d6).</p>"},{"location":"description.html#limitations","title":"Limitations","text":"<ul> <li>The sample is not multi client capable.</li> <li>The network needs up to two minutes to time out if the share is not available. This time must also be considered when the server address is corrected. Even in this case it can take a few minutes to connect to the correct server.</li> <li>Device memory information does not work on network devices.</li> <li>USB, network connection and some other features do not work when the target is in simulation mode.</li> <li>Memory information at the moment only shows total memory correct below 4GB. </li> </ul>"},{"location":"description.html#error-messages","title":"Error messages","text":"<p>The sample generates the following list of error messages. All other error numbers are generated from included libraries that can be found in the Automation Studio help.</p> No Constant Text Solution 50000 ERR_EMPTY_ITEM Selected item name is empty 50001 ERR_INVALID_ITEM_NAME This is not a valid item name 50010 ERR_DEVICE_UNDEFINED Device is not defined 50100 ERR_MAX_FILES_REACHED Maximum number of files reached Increase value of ITEM_LIST_NUN 50200 ERR_NAME_EXCEEDS_MAX File name exceeds maximum length Increase value of MAX_ITEM_SIZE 50201 ERR_DIR_EXCEEDS_MAX Directory name exceeds maximum length Increase value of MAX_ITEM_SIZE 50202 ERR_PATH_EXCEEDS_MAX Directory path exceeds maximum length Increase value of DIR_PATH_SIZE 50203 ERR_PATH_CRITICAL Directory path critical error Increase value of DIR_PATH_SIZE 50204 ERR_PATH_RECURSIVE Can not copy directory into itself Choose another directory 50331 ERR_DIR_DOWNLOAD_INVALID This is not a valid directory for downloading"},{"location":"description.html#revision-history","title":"Revision History","text":""},{"location":"description.html#version-20","title":"Version 2.0","text":"<ul> <li>Update to Automation Studio AS6</li> <li>Replaced upload and download implementation to transfer widget</li> </ul>"},{"location":"description.html#version-18","title":"Version 1.8","text":"<ul> <li>Update to Automation Studio AS 4.9 and runtime D4.90</li> <li>Revert fix from build 1.7 since bug in AsHTTP is fixed in D4.90</li> </ul>"},{"location":"description.html#version-17","title":"Version 1.7","text":"<ul> <li>Fixed data start offset in upload was not correct</li> <li>Fixed upload file name can exceed EXPL_ITEM_LENGTH</li> <li>Fixed upload crashing CPU when it exceeds EXPL_UPLOAD_DOWNLOAD_SIZE</li> </ul>"},{"location":"description.html#version-16","title":"Version 1.6","text":"<ul> <li>Fixed reset button was disabled for network and USB</li> <li>Fixed network root directory is showing all as directories</li> <li>Fixed copy directory does not report error</li> <li>Added ping OK button to network share configuration page</li> <li>Network can now be disconnected with the Reset / Abort button</li> </ul>"},{"location":"description.html#version-15","title":"Version 1.5","text":"<ul> <li>Update USB helper task</li> <li>Update NET helper task</li> <li>Prevent user from copying directories recursively</li> </ul>"},{"location":"description.html#version-14","title":"Version 1.4","text":"<ul> <li>Added support for folder download</li> <li>Renamed status to status_text and added status_no to show busy state and error numbers</li> </ul>"},{"location":"description.html#version-13","title":"Version 1.3","text":"<ul> <li>Code cleanup</li> <li>UI Tweaks</li> <li>Added file device memory information</li> <li>Added current directory entry to be compatible with network shares</li> <li>Change from static IP to DHCP</li> <li>Fixed filter text field and button is disabled when no files are visible</li> <li>Fixed file size calculation</li> <li>Fixed ReplaceString function call</li> <li>Fixed error is not showing up in wait state</li> <li>Fixed dir read and file write error is not reported</li> </ul>"},{"location":"description.html#version-12","title":"Version 1.2","text":"<ul> <li>Fixed download not working when downloading the same file again</li> <li>Fixed upload not working with large files &gt; 1 MB</li> </ul>"},{"location":"description.html#version-11","title":"Version 1.1","text":"<ul> <li>Fixed file open click event</li> <li>Added support multiple USB sticks</li> <li>Added message box when uploading or copying file that exists on target</li> <li>Fixed button rename is not disabled when command is running</li> </ul>"},{"location":"description.html#version-10","title":"Version 1.0","text":"<ul> <li>Added support for file download over mappView</li> <li>Added support for file upload over mappView</li> <li>Code cleanup</li> </ul>"},{"location":"description.html#version-09","title":"Version 0.9","text":"<ul> <li>Added function to view files by double click or command</li> </ul>"},{"location":"description.html#version-08","title":"Version 0.8","text":"<ul> <li>Added function for generating list box data provider</li> <li>Fixed typos, cleaned up binding file</li> <li>Created individual packages for NET and USB</li> <li>Fixed enable/disable</li> <li>Added message box before deleting an item</li> </ul>"},{"location":"description.html#version-07","title":"Version 0.7","text":"<ul> <li>New function rename file or folder</li> <li>Fixed memory leak when last entry in list is used</li> <li>Code optimizations</li> </ul>"},{"location":"description.html#version-06","title":"Version 0.6","text":"<ul> <li>Changed upper limit of USB polling interval</li> <li>Removed obsolete error numbers</li> <li>Replaced error numbers with constants</li> <li>Removed obsolete variables</li> <li>Fixed old_filter variable size</li> <li>Fixed file size added to file name</li> <li>Disable file device and filter during operation</li> </ul>"},{"location":"description.html#version-05","title":"Version 0.5","text":"<ul> <li>Main task ported to structure text</li> <li>Allow over sized names for files and folders</li> <li>Fixed variables types</li> <li>Applied python naming convention to all code</li> </ul>"},{"location":"description.html#version-02","title":"Version 0.2","text":"<ul> <li>Added configuration for network connections</li> <li>Code cleanup</li> </ul>"},{"location":"description.html#version-01","title":"Version 0.1","text":"<p>First public release</p>"},{"location":"import.html","title":"Import","text":"<p>This guide shows how to import the demo project into an existing project</p> <p>Open the demo project and the exiting project side by side. Go to the logical view in both projects.</p> <ol> <li>Copy the packages mappFileExplorer, USBdevice and NETdevice from the demo project</li> <li>Paste the packages into the existing project at the top</li> <li>Assign the new task to the CPU</li> <li>Make sure that the B&amp;R libraries MpFile, MpBase, MpServer, AsZip, ArBrStr, AsUSB, standard, SysLib and FileIO are in the existing project, add the libraries if needed.</li> </ol> <p></p> <ol> <li>Open the mappView tree in the demo project and navigate to ExplorerPage, right click and copy it</li> <li>In the existing project paste the page onto pages</li> <li>Assign the new task to the CPU</li> </ol> <p></p> <ol> <li>Expand the new page and double click on \u201cExplorerPage.page\u201d</li> <li>Select the default layout for the existing project the properties window</li> </ol> <p></p> <ol> <li>Once the default layout is set in the existing project click each section and make sure that correct content is selected</li> <li>Select contentExplorer for the main section</li> <li>Save the project</li> </ol> <p></p> <ol> <li>If the existing project uses a navigation bar add a new button that points to the new explorer page</li> </ol> <p></p> <ol> <li>Open the configuration view in the existing project and open the OPC configuration</li> <li>Select the global variables EXPL, NET and USB. if the variable does not show up, save and compile the project, then reopen the window</li> <li>Enable the variables with green checkmark</li> <li>Set \u201cAutomatic Enable\u201d to true in the properties window</li> </ol> <p></p> <ol> <li>Select the elements CMD, PAR, DAT and VIS</li> <li>Set \u201cShow array elements\u201d in the properties to true</li> </ol> <p></p> <ol> <li>Select the elements device_list in the sub structure EXPL.VIS[0] and EXPL.VIS[1]</li> <li>Set \u201cShow array elements\u201d in the properties to true</li> </ol> <p></p> <ol> <li>Select the element USB.PAR.is_connected</li> <li>Set \u201cShow array elements\u201d in the properties to true</li> </ol> <p></p> <ol> <li>Expand the section mappView in the existing project and select \u201cExplorer.binding\u201d and \u201cExplorer.eventbinding\u201d</li> <li>Copy the two files</li> <li>Paste the two files in the existing project under mappView</li> </ol> <p></p> <ol> <li>In the existing project open the file \u201cVisualizat.vis\u201d</li> <li>Add the ExplorerPage in the section pages</li> <li>Add the Explorer_binding in the section binding sets</li> <li>Add the Explorer_eventbinding in the section EventBindingSets</li> </ol> <p></p> <ol> <li>In the existing project open the Physical View, Right click on the CPU and open the configuration</li> <li>Navigate to files devices</li> <li>Adjust the device information. The USER_PATH is located on the 4. partition of the memory card. The size of the user partition can be configured under \"Module system on target\".</li> </ol> <p></p> <ol> <li>In the existing project open the Configuration View, click on the mappServices</li> <li>Add a new mappService of type MpFileManager</li> <li>Enter the device name from the previous step</li> <li>Add user roles and permissions as needed</li> </ol> <p></p> <p>Pay attention to the \"well known roles\" as described in the Automation Help.</p> <p></p>"}]}